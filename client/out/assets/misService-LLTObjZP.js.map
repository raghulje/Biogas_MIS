{"version":3,"file":"misService-LLTObjZP.js","sources":["../../src/services/misService.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({\r\n    baseURL: import.meta.env.DEV ? '/api' : (import.meta.env.VITE_API_URL || 'http://localhost:5001/api'),\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n    },\r\n});\r\n\r\napi.interceptors.request.use((config) => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n});\r\n\r\napi.interceptors.response.use(\r\n    (res) => res,\r\n    (err) => {\r\n        if (err.response?.status === 401) {\r\n            localStorage.removeItem('token');\r\n            if (!window.location.pathname.includes('/login')) {\r\n                window.location.href = '/login';\r\n            }\r\n        }\r\n        return Promise.reject(err);\r\n    }\r\n);\r\n\r\nexport const misService = {\r\n    createEntry: async (data: any) => {\r\n        const response = await api.post('/mis-entries', data);\r\n        return response.data;\r\n    },\r\n    getEntries: async () => {\r\n        const response = await api.get('/mis-entries');\r\n        return response.data;\r\n    },\r\n    getEntryById: async (id: number) => {\r\n        const response = await api.get(`/mis-entries/${id}`);\r\n        return response.data;\r\n    },\r\n    updateEntry: async (id: number, data: any) => {\r\n        const response = await api.put(`/mis-entries/${id}`, data);\r\n        return response.data;\r\n    },\r\n    deleteEntry: async (id: number) => {\r\n        const response = await api.delete(`/mis-entries/${id}`);\r\n        return response.data;\r\n    },\r\n    submitEntry: async (id: number) => {\r\n        const response = await api.post(`/mis-entries/${id}/submit`);\r\n        return response.data;\r\n    },\r\n    approveEntry: async (id: number) => {\r\n        const response = await api.post(`/mis-entries/${id}/approve`);\r\n        return response.data;\r\n    },\r\n    rejectEntry: async (id: number, comment: string) => {\r\n        const response = await api.post(`/mis-entries/${id}/reject`, { review_comment: comment });\r\n        return response.data;\r\n    },\r\n    exportEntries: async (params: any) => {\r\n        const response = await api.get('/mis-entries/export', { params, responseType: 'blob' });\r\n        return response.data;\r\n    },\r\n    importEntries: async (file: File) => {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        const response = await api.post('/mis-entries/import', formData, {\r\n            headers: { 'Content-Type': 'multipart/form-data' }\r\n        });\r\n        return response.data;\r\n    },\r\n    getDashboardData: async (params: { period?: string; startDate?: string; endDate?: string } = {}) => {\r\n        const period = params.period ?? 'month';\r\n        const query: Record<string, string> = { period };\r\n        if (params.startDate) query.startDate = params.startDate;\r\n        if (params.endDate) query.endDate = params.endDate;\r\n        const response = await api.get('/dashboard/daily', { params: query });\r\n        return response.data;\r\n    },\r\n    getConsolidatedData: async (params: {\r\n        startDate?: string;\r\n        endDate?: string;\r\n        financialYear?: string;\r\n        quarter?: string;\r\n        year?: string;\r\n    }) => {\r\n        const response = await api.get('/mis-entries/consolidated', { params });\r\n        return response.data;\r\n    },\r\n    /** Full MIS entries for Final MIS report (date range). */\r\n    getEntriesForReport: async (params: { startDate: string; endDate: string }) => {\r\n        const response = await api.get('/mis-entries/for-report', { params });\r\n        return response.data;\r\n    },\r\n    getImportTemplate: async (): Promise<Blob> => {\r\n        const response = await api.get('/mis-entries/import-template', { responseType: 'blob' });\r\n        return response.data;\r\n    }\r\n};\r\n"],"names":["api","axios","config","token","res","err","misService","data","id","comment","params","file","formData","query"],"mappings":"wCAEA,MAAMA,EAAMC,EAAM,OAAO,CACrB,QAAyC,4BACzC,QAAS,CACL,eAAgB,kBAAA,CAExB,CAAC,EAEDD,EAAI,aAAa,QAAQ,IAAKE,GAAW,CACrC,MAAMC,EAAQ,aAAa,QAAQ,OAAO,EAC1C,OAAIA,IACAD,EAAO,QAAQ,cAAgB,UAAUC,CAAK,IAE3CD,CACX,CAAC,EAEDF,EAAI,aAAa,SAAS,IACrBI,GAAQA,EACRC,IACOA,EAAI,UAAU,SAAW,MACzB,aAAa,WAAW,OAAO,EAC1B,OAAO,SAAS,SAAS,SAAS,QAAQ,IAC3C,OAAO,SAAS,KAAO,WAGxB,QAAQ,OAAOA,CAAG,EAEjC,EAEO,MAAMC,EAAa,CACtB,YAAa,MAAOC,IACC,MAAMP,EAAI,KAAK,eAAgBO,CAAI,GACpC,KAEpB,WAAY,UACS,MAAMP,EAAI,IAAI,cAAc,GAC7B,KAEpB,aAAc,MAAOQ,IACA,MAAMR,EAAI,IAAI,gBAAgBQ,CAAE,EAAE,GACnC,KAEpB,YAAa,MAAOA,EAAYD,KACX,MAAMP,EAAI,IAAI,gBAAgBQ,CAAE,GAAID,CAAI,GACzC,KAEpB,YAAa,MAAOC,IACC,MAAMR,EAAI,OAAO,gBAAgBQ,CAAE,EAAE,GACtC,KAEpB,YAAa,MAAOA,IACC,MAAMR,EAAI,KAAK,gBAAgBQ,CAAE,SAAS,GAC3C,KAEpB,aAAc,MAAOA,IACA,MAAMR,EAAI,KAAK,gBAAgBQ,CAAE,UAAU,GAC5C,KAEpB,YAAa,MAAOA,EAAYC,KACX,MAAMT,EAAI,KAAK,gBAAgBQ,CAAE,UAAW,CAAE,eAAgBC,CAAA,CAAS,GACxE,KAEpB,cAAe,MAAOC,IACD,MAAMV,EAAI,IAAI,sBAAuB,CAAE,OAAAU,EAAQ,aAAc,OAAQ,GACtE,KAEpB,cAAe,MAAOC,GAAe,CACjC,MAAMC,EAAW,IAAI,SACrB,OAAAA,EAAS,OAAO,OAAQD,CAAI,GACX,MAAMX,EAAI,KAAK,sBAAuBY,EAAU,CAC7D,QAAS,CAAE,eAAgB,qBAAA,CAAsB,CACpD,GACe,IACpB,EACA,iBAAkB,MAAOF,EAAoE,KAAO,CAEhG,MAAMG,EAAgC,CAAE,OADzBH,EAAO,QAAU,OACQ,EACxC,OAAIA,EAAO,YAAWG,EAAM,UAAYH,EAAO,WAC3CA,EAAO,UAASG,EAAM,QAAUH,EAAO,UAC1B,MAAMV,EAAI,IAAI,mBAAoB,CAAE,OAAQa,EAAO,GACpD,IACpB,EACA,oBAAqB,MAAOH,IAOP,MAAMV,EAAI,IAAI,4BAA6B,CAAE,OAAAU,EAAQ,GACtD,KAGpB,oBAAqB,MAAOA,IACP,MAAMV,EAAI,IAAI,0BAA2B,CAAE,OAAAU,EAAQ,GACpD,KAEpB,kBAAmB,UACE,MAAMV,EAAI,IAAI,+BAAgC,CAAE,aAAc,OAAQ,GACvE,IAExB"}