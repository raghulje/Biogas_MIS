const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/misService-LLTObjZP.js","assets/index-D5WwrTj-.js","assets/index-66xdpVNw.css","assets/MISFormView-vWBXHFn_.js","assets/Layout-BXTkXNOz.js","assets/srel-BMzgRxSF.js","assets/Grid-CDTwfBGP.js","assets/Button-Dm6J5fh5.js","assets/FileDownload-CvIEObuY.js","assets/DialogContent-C2pFBHRZ.js","assets/Chip-Bs8bSymi.js","assets/Save-BhuREFE_.js","assets/Alert-CqN-3oq6.js"])))=>i.map(i=>d[i]);
import{j as e,r as s,B as y,C as M,_ as A}from"./index-D5WwrTj-.js";import{c as P,T as w,a as G,M as D,b as L,I as T,L as oe}from"./Layout-BXTkXNOz.js";import{B as j}from"./Button-Dm6J5fh5.js";import{F as H,A as ae,E as ne,D as le,a as ie}from"./FileDownload-CvIEObuY.js";import{C as K,a as ce,G as v}from"./Grid-CDTwfBGP.js";import{F as de,I as ue,L as Q,A as $,D as q}from"./AdapterDateFns-BQbOmZZj.js";import{R as xe}from"./Refresh-DVh_hkbX.js";import{T as he,a as ge,b as pe,c as V,d as o,e as me}from"./TableRow-D-rGV0Jk.js";import{C as fe}from"./Chip-Bs8bSymi.js";import{D as be,a as je,b as ve}from"./DialogContent-C2pFBHRZ.js";import{misService as _}from"./misService-LLTObjZP.js";import"./srel-BMzgRxSF.js";const ye=P(e.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload"),Se=P(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),Ce=P(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility");function J(c){if(!c||typeof c!="string")return"Draft";const a=c.toLowerCase();return a==="approved"?"Approved":a==="submitted"||a==="under_review"?"Submitted":a==="rejected"?"Rejected":a==="deleted"?"Deleted":a.charAt(0).toUpperCase()+a.slice(1)}function De({entries:c,onCreateNew:a,onEdit:F,onView:B,onDelete:W,onImportSuccess:m}){const[S,h]=s.useState(""),[g,I]=s.useState("All"),[u,R]=s.useState(null),[p,k]=s.useState(null),[O,f]=s.useState(!1),[C,E]=s.useState(null),[b,n]=s.useState(!1),[l,N]=s.useState(!1),Y=async t=>{const r=t.target.files?.[0];if(r){n(!0);try{const{misService:i}=await A(async()=>{const{misService:d}=await import("./misService-LLTObjZP.js");return{misService:d}},__vite__mapDeps([0,1,2]));await i.importEntries(r),alert("Data imported successfully!"),m?.()}catch(i){console.error(i),alert("Import failed: "+(i.response?.data?.message||i.message))}finally{n(!1),t.target.value=""}}},Z=async()=>{N(!0);try{const{misService:t}=await A(async()=>{const{misService:z}=await import("./misService-LLTObjZP.js");return{misService:z}},__vite__mapDeps([0,1,2])),r={};u&&(r.startDate=u.toISOString().slice(0,10)),p&&(r.endDate=p.toISOString().slice(0,10)),g!=="All"&&(r.status=g.toLowerCase());const i=await t.exportEntries(r),d=URL.createObjectURL(i),x=document.createElement("a");x.href=d,x.download=`mis_entries_export_${new Date().toISOString().slice(0,10)}.xlsx`,x.click(),URL.revokeObjectURL(d)}catch(t){console.error(t),alert("Export failed: "+(t.response?.data?.message||t.message))}finally{N(!1)}},ee=async()=>{try{const{misService:t}=await A(async()=>{const{misService:x}=await import("./misService-LLTObjZP.js");return{misService:x}},__vite__mapDeps([0,1,2])),r=await t.getImportTemplate(),i=URL.createObjectURL(r),d=document.createElement("a");d.href=i,d.download="MIS_Import_Template.xlsx",d.click(),URL.revokeObjectURL(i)}catch(t){console.error(t),alert("Failed to download template: "+(t.response?.data?.message||t.message))}},U=c.filter(t=>{const r=String(t.id).toLowerCase().includes(S.toLowerCase())||t.createdBy&&String(t.createdBy).toLowerCase().includes(S.toLowerCase()),i=J(t.status),d=g==="All"||i===g,x=new Date(t.date),z=(!u||x>=u)&&(!p||x<=p);return r&&d&&z}),te=t=>{E(t),f(!0)},re=()=>{C&&(W(C),f(!1),E(null))},se=t=>{const r=(t||"").toLowerCase();return r==="submitted"||r==="under_review"?{bg:"rgba(40, 121, 182, 0.1)",color:"#2879b6"}:r==="approved"?{bg:"rgba(125, 194, 68, 0.1)",color:"#7dc244"}:r==="draft"?{bg:"rgba(245, 158, 33, 0.1)",color:"#F59E21"}:r==="rejected"?{bg:"rgba(239, 68, 68, 0.1)",color:"#ef4444"}:r==="deleted"?{bg:"rgba(88, 89, 91, 0.2)",color:"#58595B"}:{bg:"rgba(88, 89, 91, 0.1)",color:"#58595B"}};return e.jsxs(y,{className:"aos-fade-up",children:[e.jsxs(y,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[e.jsx(w,{variant:"h4",sx:{fontWeight:700,color:"#2879b6"},children:"MIS Entry Records"}),e.jsxs(y,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(j,{variant:"outlined",startIcon:e.jsx(H,{}),onClick:ee,sx:{textTransform:"none",borderRadius:"12px",borderColor:"#2879b6",color:"#2879b6",fontWeight:600,px:3,py:1.2},children:"Download Template"}),e.jsx("input",{type:"file",id:"import-excel",style:{display:"none"},accept:".xlsx, .xls",onChange:Y}),e.jsx("label",{htmlFor:"import-excel",children:e.jsx(j,{component:"span",variant:"contained",startIcon:b?e.jsx(M,{size:20}):e.jsx(ye,{}),disabled:b,className:"btn-gradient-primary",sx:{textTransform:"none",borderRadius:"12px",px:3,py:1.2,borderColor:"#2879b6",fontWeight:600},children:b?"Importing…":"Import"})}),e.jsx(j,{variant:"contained",startIcon:l?e.jsx(M,{size:20}):e.jsx(H,{}),onClick:Z,disabled:l||c.length===0,sx:{textTransform:"none",borderRadius:"12px",px:3,py:1.2,backgroundColor:"#58595B",color:"#fff",fontWeight:600,"&:hover":{backgroundColor:"#333842"}},children:l?"Exporting…":"Export"}),e.jsx(j,{variant:"contained",startIcon:e.jsx(ae,{}),onClick:a,className:"btn-gradient-success",sx:{textTransform:"none",borderRadius:"12px",px:3,py:1.2,color:"#fff",fontWeight:600,whiteSpace:"nowrap"},children:"Create New Entry"})]})]}),e.jsx(K,{className:"glass-card hover-lift aos-fade-up aos-delay-100",sx:{mb:3,borderRadius:"20px",overflow:"hidden"},children:e.jsxs(ce,{sx:{p:3},children:[e.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1,mb:2.5},children:[e.jsx(de,{sx:{color:"#2879b6"}}),e.jsx(w,{variant:"h6",sx:{fontWeight:600,color:"#333842"},children:"Filter Records"})]}),e.jsxs(v,{container:!0,spacing:2.5,children:[e.jsx(v,{item:!0,xs:12,md:4,children:e.jsx(G,{fullWidth:!0,placeholder:"Search by ID or Creator...",value:S,onChange:t=>h(t.target.value),InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(Se,{sx:{color:"#58595B"}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.8)"}}})}),e.jsx(v,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(G,{fullWidth:!0,select:!0,label:"Status",value:g,onChange:t=>I(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.8)"}},children:[e.jsx(D,{value:"All",children:"All Status"}),e.jsx(D,{value:"Draft",children:"Draft"}),e.jsx(D,{value:"Submitted",children:"Submitted"}),e.jsx(D,{value:"Approved",children:"Approved"}),e.jsx(D,{value:"Rejected",children:"Rejected"})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:2.5,children:e.jsx(Q,{dateAdapter:$,children:e.jsx(q,{label:"From Date",value:u,onChange:t=>R(t),slotProps:{textField:{fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.8)"}}}}})})}),e.jsx(v,{item:!0,xs:12,sm:6,md:2.5,children:e.jsx(Q,{dateAdapter:$,children:e.jsx(q,{label:"To Date",value:p,onChange:t=>k(t),slotProps:{textField:{fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.8)"}}}}})})}),e.jsx(v,{item:!0,xs:12,sm:6,md:1,children:e.jsx(L,{title:"Reset Filters",children:e.jsx(T,{onClick:()=>{h(""),I("All"),R(null),k(null)},sx:{width:"100%",height:"56px",borderRadius:"12px",backgroundColor:"rgba(238, 106, 49, 0.1)",color:"#ee6a31","&:hover":{backgroundColor:"rgba(238, 106, 49, 0.2)"}},children:e.jsx(xe,{})})})})]})]})}),e.jsx(K,{className:"glass-card-strong aos-fade-up aos-delay-200",sx:{borderRadius:"20px",overflow:"hidden"},children:e.jsx(he,{children:e.jsxs(ge,{children:[e.jsx(pe,{children:e.jsxs(V,{sx:{background:"linear-gradient(135deg, rgba(40, 121, 182, 0.1) 0%, rgba(125, 194, 68, 0.1) 100%)"},children:[e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"Entry ID"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"Date"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"Created By"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"Status"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"CBG Produced"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},children:"Total Biogas"}),e.jsx(o,{sx:{fontWeight:700,color:"#2879b6",fontSize:"0.95rem"},align:"center",children:"Actions"})]})}),e.jsxs(me,{children:[U.map(t=>{const r=se(t.status);return e.jsxs(V,{className:"hover-lift",sx:{transition:"all 0.3s ease","&:hover":{backgroundColor:"rgba(40, 121, 182, 0.03)"}},children:[e.jsx(o,{sx:{fontWeight:600,color:"#333842"},children:t.id}),e.jsx(o,{children:new Date(t.date).toLocaleDateString()}),e.jsx(o,{children:t.createdBy}),e.jsx(o,{children:e.jsx(fe,{label:J(t.status),size:"small",sx:{fontWeight:600,backgroundColor:r.bg,color:r.color,borderRadius:"8px"}})}),e.jsxs(o,{sx:{fontWeight:500},children:[t.compressedBiogas?.produced??0," kg"]}),e.jsxs(o,{sx:{fontWeight:500},children:[t.rawBiogas?.totalRawBiogas??0," m³"]}),e.jsx(o,{align:"center",children:e.jsxs(y,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[e.jsx(L,{title:"View Details",children:e.jsx(T,{size:"small",onClick:()=>B(t),sx:{color:"#2879b6",backgroundColor:"rgba(40, 121, 182, 0.1)",borderRadius:"10px","&:hover":{backgroundColor:"rgba(40, 121, 182, 0.2)"}},children:e.jsx(Ce,{fontSize:"small"})})}),e.jsx(L,{title:"Edit Entry",children:e.jsx(T,{size:"small",onClick:()=>F(t),sx:{color:"#7dc244",backgroundColor:"rgba(125, 194, 68, 0.1)",borderRadius:"10px","&:hover":{backgroundColor:"rgba(125, 194, 68, 0.2)"}},children:e.jsx(ne,{fontSize:"small"})})}),e.jsx(L,{title:"Delete Entry",children:e.jsx(T,{size:"small",onClick:()=>te(t),sx:{color:"#ee6a31",backgroundColor:"rgba(238, 106, 49, 0.1)",borderRadius:"10px","&:hover":{backgroundColor:"rgba(238, 106, 49, 0.2)"}},children:e.jsx(le,{fontSize:"small"})})})]})})]},t.id)}),U.length===0&&e.jsx(V,{children:e.jsx(o,{colSpan:7,align:"center",sx:{py:6},children:e.jsx(w,{variant:"body1",sx:{color:"#58595B"},children:"No records found matching your criteria"})})})]})]})})}),e.jsxs(be,{open:O,onClose:()=>f(!1),PaperProps:{sx:{borderRadius:"20px",p:1}},children:[e.jsx(ie,{sx:{fontWeight:600,color:"#ee6a31"},children:"Confirm Delete"}),e.jsx(je,{children:e.jsxs(w,{children:["Are you sure you want to delete entry ",e.jsx("strong",{children:C?.id}),"? This action cannot be undone."]})}),e.jsxs(ve,{sx:{p:2.5},children:[e.jsx(j,{onClick:()=>f(!1),sx:{textTransform:"none",color:"#58595B",borderRadius:"12px"},children:"Cancel"}),e.jsx(j,{variant:"contained",onClick:re,sx:{textTransform:"none",backgroundColor:"#ee6a31",borderRadius:"12px",whiteSpace:"nowrap","&:hover":{backgroundColor:"#d55a28"}},children:"Delete"})]})]})]})}const we=s.lazy(()=>A(()=>import("./MISFormView-vWBXHFn_.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,0,10,11,12]))),X=[{id:1,name:"Digester 01",feeding:{totalSlurryFeed:0,avgTs:0,avgVs:0},discharge:{totalSlurryOut:0,avgTs:0,avgVs:0},characteristics:{lignin:0,vfa:0,alkalinity:0,vfaAlkRatio:0,ash:0,density:0,ph:0,temperature:0,pressure:0,slurryLevel:0},health:{hrt:0,vsDestruction:0,olr:0,balloonLevel:0,agitatorCondition:"OK",foamingLevel:0}},{id:2,name:"Digester 02",feeding:{totalSlurryFeed:0,avgTs:0,avgVs:0},discharge:{totalSlurryOut:0,avgTs:0,avgVs:0},characteristics:{lignin:0,vfa:0,alkalinity:0,vfaAlkRatio:0,ash:0,density:0,ph:0,temperature:0,pressure:0,slurryLevel:0},health:{hrt:0,vsDestruction:0,olr:0,balloonLevel:0,agitatorCondition:"OK",foamingLevel:0}},{id:3,name:"Digester 03",feeding:{totalSlurryFeed:0,avgTs:0,avgVs:0},discharge:{totalSlurryOut:0,avgTs:0,avgVs:0},characteristics:{lignin:0,vfa:0,alkalinity:0,vfaAlkRatio:0,ash:0,density:0,ph:0,temperature:0,pressure:0,slurryLevel:0},health:{hrt:0,vsDestruction:0,olr:0,balloonLevel:0,agitatorCondition:"OK",foamingLevel:0}}];function ze(){const[c,a]=s.useState("list"),[F,B]=s.useState([]),[W,m]=s.useState(null),[S,h]=s.useState(!1),[g,I]=s.useState(X);s.useEffect(()=>{c==="list"&&u()},[c]);const u=async()=>{try{const n=await _.getEntries();B(n)}catch(n){console.error("Failed to fetch entries",n)}},R=async n=>{h(!0);try{const l=await _.getEntryById(n.id);m(l),a("edit")}catch(l){console.error(l),alert("Failed to load entry details")}finally{h(!1)}},p=async n=>{h(!0);try{const l=await _.getEntryById(n.id);m(l),a("view")}catch(l){console.error(l),alert("Failed to load entry details")}finally{h(!1)}},k=async n=>{try{await _.deleteEntry(n.id),u()}catch(l){console.error("Failed to delete entry",l),alert("Failed to delete entry")}},O=()=>{m(null),I(X),a("create")},f=()=>{a("list"),m(null)},C=()=>{},E=n=>{},b=e.jsxs(y,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:320,gap:2,bgcolor:"rgba(255,255,255,0.9)",borderRadius:2,p:4},children:[e.jsx(M,{size:48,sx:{color:"#2879b6"}}),e.jsx(w,{variant:"body1",sx:{color:"#58595B",fontWeight:500},children:"Loading form…"})]});return e.jsx(oe,{children:S?b:c==="list"?e.jsx(De,{entries:F,onCreateNew:O,onEdit:R,onView:p,onDelete:k,onImportSuccess:u}):e.jsx(s.Suspense,{fallback:b,children:e.jsx(we,{viewMode:c,selectedEntry:W,digesters:g,onBackToList:f,onAddDigester:C,onRemoveDigester:E})})})}export{ze as default};
//# sourceMappingURL=page-C607z-T9.js.map
